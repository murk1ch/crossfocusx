<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –∫–æ–¥—ã</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: linear-gradient(135deg, #6a11cb, #2575fc); color: white; min-height: 100vh; padding: 20px; }
    .card { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius: 10px; padding: 20px; }
    .btn-light { background-color: #fff; color: #6a11cb; font-weight: bold; }
    .btn-light:hover { background-color: #e0d4ff; }
    table { color: white; }
  </style>
</head>
<body>
<div class="container">
  <h1 class="mb-4">–†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –∫–æ–¥—ã</h1>

  <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
  <div class="mb-3">
    <a href="/dashboard" class="btn btn-light btn-sm">–ö–ª—é—á–∏</a>
    <a href="/referrals" class="btn btn-light btn-sm">–†–µ—Ñ–µ—Ä–∞–ª—ã</a>
    <a href="/logout" class="btn btn-warning btn-sm">–í—ã–π—Ç–∏</a>
  </div>

  <!-- –°–æ–∑–¥–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞ -->
  <div class="card mb-4">
    <h4>–°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç‚Äë–º–µ–π–∫–µ—Ä–∞</h4>
    <form method="POST" action="/creator/create" class="row g-2 mt-2">
      <div class="col-md-3"><input name="nickname" class="form-control" placeholder="–ù–∏–∫" required></div>
      <div class="col-md-3"><input name="yt_url" class="form-control" placeholder="YouTube URL"></div>
      <div class="col-md-3"><input name="tt_url" class="form-control" placeholder="TikTok URL"></div>
      <div class="col-md-3"><input name="ig_url" class="form-control" placeholder="Instagram URL"></div>
      <div class="col-md-2"><input name="commission_percent" type="number" class="form-control" placeholder="% –∫–æ–º–∏—Å—Å–∏–∏" value="10"></div>
      <div class="col-md-6"><input name="note" class="form-control" placeholder="–ó–∞–º–µ—Ç–∫–∞"></div>
      <div class="col-md-2"><button class="btn btn-light w-100">–°–æ–∑–¥–∞—Ç—å</button></div>
    </form>
  </div>

  <!-- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞ -->
  <div class="card mb-4">
    <h4>–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</h4>
    <form method="POST" action="/promo/create" class="row g-2 mt-2">
      <div class="col-md-3"><input name="code" class="form-control" placeholder="–ü—Ä–æ–º–æ–∫–æ–¥" required></div>
      <div class="col-md-3">
        <select name="creator_id" class="form-control">
          <option value="">‚Äî –±–µ–∑ –∞–≤—Ç–æ—Ä–∞ ‚Äî</option>
          {% for c in creators %}
            <option value="{{ c.id }}">{{ c.nickname }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-2"><input name="bonus_days" type="number" class="form-control" value="7" placeholder="+ –¥–Ω–µ–π"></div>
      <div class="col-md-2"><input name="max_uses" type="number" class="form-control" value="0" placeholder="–õ–∏–º–∏—Ç (0 ‚Äî –Ω–µ—Ç)"></div>
      <div class="col-md-3"><input name="end_at" class="form-control" placeholder="–û–∫–æ–Ω—á–∞–Ω–∏–µ (YYYY-MM-DD HH:MM)"></div>
      <div class="col-md-3">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="only_new_users" id="onlyNew">
          <label class="form-check-label" for="onlyNew">–¢–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö</label>
        </div>
      </div>
      <div class="col-md-6"><input name="note" class="form-control" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ/–∑–∞–º–µ—Ç–∫–∞"></div>
      <div class="col-md-2"><button class="btn btn-light w-100">–°–æ–∑–¥–∞—Ç—å</button></div>
    </form>
  </div>

  <!-- –°–ø–∏—Å–æ–∫ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ -->
  <div class="card mb-4">
    <h4>–°–ø–∏—Å–æ–∫ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤</h4>
    <table class="table table-dark table-striped mt-3">
      <thead>
        <tr>
          <th>ID</th><th>–ö–æ–¥</th><th>–ê–≤—Ç–æ—Ä</th><th>–ë–æ–Ω—É—Å</th><th>–õ–∏–º–∏—Ç</th><th>–°—Ä–æ–∫</th><th>–ê–∫—Ç–∏–≤–µ–Ω</th><th>–ò—Å–ø.</th><th>–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
      </thead>
      <tbody>
        {% for p in codes %}
        <tr>
          <td>{{ p.id }}</td>
          <td>{{ p.code }}</td>
          <td>{{ p.creator_nickname or '‚Äî' }}</td>
          <td>{{ p.bonus_days }} –¥–Ω.</td>
          <td>{{ p.max_uses or '‚àû' }}</td>
          <td>
            {{ p.start_at|format_datetime }} ‚Äî
            {% if p.end_at %}{{ p.end_at|format_datetime }}{% else %}‚àû{% endif %}
          </td>
          <td>{{ '–î–∞' if p.active else '–ù–µ—Ç' }}</td>
          <td>{{ stats.get(p.code, 0) }}</td>
          <td>
            <a href="{{ url_for('promo_toggle', code=p.code) }}" class="btn btn-warning btn-sm">‚õî/‚úÖ</a>
            <form method="POST" action="{{ url_for('promo_delete', code=p.code) }}" style="display:inline;">
              <button class="btn btn-danger btn-sm" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å {{ p.code }}?');">üóë</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- –†—É—á–Ω–æ–π —É—á—ë—Ç –ø–æ–∫—É–ø–æ–∫ -->
  <div class="card mb-4">
    <h4>–î–æ–±–∞–≤–∏—Ç—å –ø–æ–∫—É–ø–∫—É (–¥–ª—è –∫–æ–º–∏—Å—Å–∏–π)</h4>
    <form method="POST" action="/purchase/create" class="row g-2 mt-2">
      <div class="col-md-3"><input name="key" class="form-control" placeholder="–õ–∏—Ü–µ–Ω–∑–∏—è KEY" required></div>
      <div class="col-md-2"><input name="amount" type="number" step="0.01" class="form-control" placeholder="–°—É–º–º–∞" required></div>
      <div class="col-md-3"><input name="code" class="form-control" placeholder="–ü—Ä–æ–º–æ–∫–æ–¥ (–æ–ø—Ü.)"></div>
      <div class="col-md-2"><button class="btn btn-light w-100">–î–æ–±–∞–≤–∏—Ç—å</button></div>
    </form>
  </div>
</div>
</body>
</html>
